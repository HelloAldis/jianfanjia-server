<div class="row user-page common">
	<date-range-picker config="config" delegate="delegate" dt-start="dtStart" dt-end="dtEnd"></date-range-picker>
	<search-input config="config" delegate="delegate"></search-input>

	<div class="panel panel-info ng-scope text-center table-responsive">
		<table class="table table-bordered table-striped">
			<tbody>
				<tr class="info thead text-nowrap">
					<th class="user-id text-center">业主ID</th>
					<th>
						<div ng-class="{'-1':'tablesorter-headerDesc item-width',
							undefined:'tablesorter-header item-width',
							'1':'tablesorter-headerAsc item-width'}[sort.create_at]"
							 ng-click="sortData('create_at')">注册时间&nbsp;&nbsp;
						</div>
					</th>
					<th>
						<div ng-class="{'-1':'tablesorter-headerDesc item-width',
							undefined:'tablesorter-header item-width',
							'1':'tablesorter-headerAsc item-width'}[sort.username]"
							 ng-click="sortData('username')">业主姓名&nbsp;&nbsp;</div>
					</th>
					<th>
						<div ng-class="{'-1':'tablesorter-headerDesc item-width',
							undefined:'tablesorter-header item-width',
							'1':'tablesorter-headerAsc item-width'}[sort.phone]"
							 ng-click="sortData('phone')">业主电话&nbsp;&nbsp;</div>
					</th>
					<th class="text-center">业主性别</th>
					<th class="text-center">查看详细资料</th>
					<th class="text-center">查看需求列表</th>
					<th class="text-center">操作</th>
				</tr>
				<tr ng-repeat="user in userList" class="text-nowrap">
					<td>{{user._id}}</td>
					<td class="text-left">{{user.create_at | date:'yyyy-MM-dd HH:mm:ss'}}</td>
					<td class="text-left">{{user.username ? user.username : '未填写'}}</td>
					<td class="text-left">{{user.phone}}</td>
					<td>{{user.sex ? (user.sex | sexFilter) : '未填写'}}</td>
					<td><a ui-sref="userInfo({id:user._id})">点击查看</a></td>
					<td>
						<a ng-show="{{user.requirement.length > 0}}"
							 ui-sref="userRequirement({id:user._id})">点击查看({{user.requirement.length}})</a>
						<span ng-show="{{user.requirement.length == 0}}">暂无需求</span>
					</td>
					<td>
						<button type="button" class="btn btn-primary" data-toggle="modal"
							ng-click="showModel(user._id)">提交需求</button>
					</td>
				</tr>
			</tbody>
		</table>
		<load-data ng-hide="loading.loadData"></load-data>
		<no-data ng-if="loading.notData"></no-data>
	</div>

	<div class="paginat">
		<div class="text-center" ng-if="loading.loadData && !loading.notData">
			<uib-pagination total-items="pagination.totalItems" first-text="首页"
					next-text="下一页" previous-text="上一页" last-text="尾页"
					ng-model="pagination.currentPage" max-size="pagination.maxSize"
					class="pagination-sm" boundary-links="true" num-pages="numPages"
				  rotate="false" ng-change="pagination.pageChanged()"></uib-pagination>
			<span class="pagecode">当前：{{pagination.currentPage}} / {{numPages}} 页 总共 {{pagination.totalItems}} 条数据</span>
		</div>
	</div>
	<div class="col-md-12 data-edit">
		<div export-data class="hidden-xs"></div>
		<button type="button" class="btn btn-primary" data-toggle="modal" ng-click="showModel()">添加业主</button>
	</div>

	<!-- 添加业主 -->
	<div class="modal fade in activeModal" tabindex="-1" role="dialog">
		<div class="modal-dialog" role="supervisor">
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal" aria-label="Close">
						<span aria-hidden="true">&times;</span>
					</button>
					<h4 class="modal-title">添加业主</h4>
				</div>
				<div class="modal-body">
					<form>
						<div class="form-group">
							<label for="message-phone" class="control-label">电话:</label>
							<input type="number" class="form-control" ng-model="user.phone">
						</div>
						<div class="form-group">
							<label for="message-pass" class="control-label">密码:</label>
							<input type="text" class="form-control" ng-model="user.pass">
						</div>
						<div class="form-group">
							<label for="message-name" class="control-label">姓名:</label>
							<input type="text" class="form-control" ng-model="user.username">
						</div>
						<div class="form-group">
							<label class="control-label err-msg">{{user.errMsg}}</label>
						</div>
					</form>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
					<button type="button" class="btn btn-primary" ng-click="addUser()">确认</button>
				</div>
			</div>
		</div>
	</div>

	<!-- 提交需求 -->
	<div class="modal fade in modalRequirement" tabindex="-1" role="dialog">
		<div class="modal-dialog" role="requirement">
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal" aria-label="Close">
						<span aria-hidden="true">&times;</span>
					</button>
					<h4 class="modal-title">提交业主需求</h4>
				</div>
				<div class="modal-body">
					<form>
						<div class="form-group">
							<label for="exampleInputPassword1">装修城市：</label>
							<my-cities my-province="dataMapped.province" my-city="dataMapped.city" my-district="dataMapped.district" />
						</div>
						<div class="form-group row">
							<label for="message-phone" class="control-label col-md-3">小区名称:</label>
							<input type="text" class="col-md-9" ng-model="dataMapped.basic_address">
						</div>
						<div class="form-group row">
							<label for="message-phone" class="control-label col-md-3">详细地址:</label>
							<input type="text" class="col-md-9" ng-model="dataMapped.detail_address">
						</div>
						<div class="form-group row">
							<label for="message-name" class="control-label col-md-3">户型:</label>
							<kv-dropdown curkey="dataMapped.house_type" keyval="num:name" opts="house_type">
					    </kv-dropdown>
						</div>
						<div class="form-group row">
							<label for="message-name" class="control-label col-md-3">包工类型:</label>
							<kv-dropdown curkey="dataMapped.work_type" keyval="num:name" opts="work_type">
					    </kv-dropdown>
						</div>
						<div class="form-group row">
							<label for="message-name" class="control-label col-md-3">包类型:</label>
							<kv-dropdown curkey="dataMapped.package_type" keyval="num:name" opts="package_type">
					    </kv-dropdown>
						</div>
						<div class="form-group row">
							<label for="message-name" class="control-label col-md-3">建筑面积(m²):</label>
							<input type="text" class="col-md-9" ng-model="dataMapped.house_area" placeholder="请填写整数">
						</div>
						<div class="form-group row">
							<label for="message-name" class="control-label col-md-3">风格喜好:</label>
							<kv-dropdown curkey="dataMapped.dec_style" keyval="num:name" opts="dec_style">
					    </kv-dropdown>
						</div>
						<div class="form-group row">
							<label for="message-name" class="control-label col-md-3">装修预算(万元):</label>
							<input type="text" class="col-md-9" ng-model="dataMapped.total_price" placeholder="请填写整数">
						</div>
						<div class="form-group row">
							<label for="message-name" class="control-label col-md-3">偏好设计师性别:</label>
							<kv-dropdown curkey="dataMapped.prefer_sex" keyval="num:name" opts="prefer_sex">
					    </kv-dropdown>
						</div>
						<div class="form-group row">
							<label for="message-name" class="control-label col-md-3">偏好设计师类型:</label>
							<kv-dropdown curkey="dataMapped.communication_type" keyval="num:name" opts="communication_type">
					    </kv-dropdown>
						</div>
						<div class="form-group row">
							<label class="control-label err-msg">{{dataMapped.errMsg}}</label>
						</div>
					</form>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
					<button type="button" class="btn btn-primary" ng-click="addUserRequirement()">确认</button>
				</div>
			</div>
		</div>
	</div>
</div>
