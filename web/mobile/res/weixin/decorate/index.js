var timer,windowInnerHeight;var oForm=$("#form");var oPage=$("#page");var oSubmit=$("#info-submit");var oName=$("#name");var oPhone=$("#phone");var aError=$(".errotMsg");var oFooter=$("#footer");var oTips=$("#tips");function isMobile(a){return/^(13[0-9]{9}|15[012356789][0-9]{8}|18[0123456789][0-9]{8}|147[0-9]{8}|170[0-9]{8}|177[0-9]{8})$/.test(a)}on(oName,"focus",function(){fixedHide()});on(oName,"blur",function(){if(!this.value.trim()){html(aError[1],"姓名不能为空");addClass(this,"error")}fixedShow()});on(oPhone,"blur",function(){if(!isMobile(this.value)){html(aError[0],"手机号不正确");addClass(this,"error")}fixedShow()});on(oPhone,"focus",function(){fixedHide()});on(oName,"input",function(){if(oName.value.trim()){html(aError[1],"");removeClass(this,"error")}unDisabled()});on(oPhone,"input",function(){if(isMobile(this.value)){html(aError[0],"");removeClass(this,"error")}unDisabled()});function fixedHide(){oFooter.style.display="none";oFooter.style.position="static";oFooter.style.display="block";setTimeout(function(){windowInnerHeight=window.innerHeight;timer=setInterval(function(){if(window.innerHeight>windowInnerHeight){oName.blur();oPhone.blur();clearInterval(timer)}},100)},500)}function fixedShow(){oFooter.style.display="none";oFooter.style.position="fixed";oFooter.style.bottom="0px";oFooter.style.display="block"}function unDisabled(){if(!!oName.value.trim()&&isMobile(oPhone.value)){removeClass(oSubmit,"disabled");oSubmit.disabled=false}else{addClass(oSubmit,"disabled");oSubmit.disabled=true}}on(oForm,"submit",function(a){a.preventDefault();if(oSubmit.disabled){return false}oFooter.style.display="none";ajax({url:"/api/v2/web/add_angel_user",type:"POST",data:JSON.stringify({phone:oPhone.value,name:oName.value.trim(),district:"繁-",house_area:undefined,total_price:undefined}),dataType:"json",contentType:"application/json; charset=utf-8",success:function(b){if(JSON.parse(b).msg==="success"){oTips.style.display="block";oPage.style.display="none";setTimeout(function(){oName.value="";oPhone.value="";oFooter.style.display="block";oTips.style.display="none";oPage.style.display="block"},5000)}},fail:function(b){alert("网络不给力")}});return false});